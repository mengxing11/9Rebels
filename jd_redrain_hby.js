/*
京豆红包雨

cron:1 1 1 1 * jd_redrain_hby.js

*/

const $ = new Env('京豆红包雨');
var iｉl='jsjiami.com.v7';function iii1II(_0x439e0e,_0x13f12d){const _0x5df33a=Iii11l();return iii1II=function(_0xaeeb10,_0x542632){_0xaeeb10=_0xaeeb10-0x85;let _0x41da8f=_0x5df33a[_0xaeeb10];if(iii1II['qBSXdP']===undefined){var _0x2751fe=function(_0x60b9ed){const _0x570815='abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789+/=';let _0x4aaea5='',_0x101d3c='';for(let _0x398282=0x0,_0x3f8538,_0x1584ee,_0x2a070f=0x0;_0x1584ee=_0x60b9ed['charAt'](_0x2a070f++);~_0x1584ee&&(_0x3f8538=_0x398282%0x4?_0x3f8538*0x40+_0x1584ee:_0x1584ee,_0x398282++%0x4)?_0x4aaea5+=String['fromCharCode'](0xff&_0x3f8538>>(-0x2*_0x398282&0x6)):0x0){_0x1584ee=_0x570815['indexOf'](_0x1584ee);}for(let _0x5e7342=0x0,_0x30cfb1=_0x4aaea5['length'];_0x5e7342<_0x30cfb1;_0x5e7342++){_0x101d3c+='%'+('00'+_0x4aaea5['charCodeAt'](_0x5e7342)['toString'](0x10))['slice'](-0x2);}return decodeURIComponent(_0x101d3c);};const _0x46ca1=function(_0x2edb62,_0x49de4a){let _0x5526e8=[],_0x3b5c35=0x0,_0x4527f2,_0x58e265='';_0x2edb62=_0x2751fe(_0x2edb62);let _0x468731;for(_0x468731=0x0;_0x468731<0x100;_0x468731++){_0x5526e8[_0x468731]=_0x468731;}for(_0x468731=0x0;_0x468731<0x100;_0x468731++){_0x3b5c35=(_0x3b5c35+_0x5526e8[_0x468731]+_0x49de4a['charCodeAt'](_0x468731%_0x49de4a['length']))%0x100,_0x4527f2=_0x5526e8[_0x468731],_0x5526e8[_0x468731]=_0x5526e8[_0x3b5c35],_0x5526e8[_0x3b5c35]=_0x4527f2;}_0x468731=0x0,_0x3b5c35=0x0;for(let _0x501b5a=0x0;_0x501b5a<_0x2edb62['length'];_0x501b5a++){_0x468731=(_0x468731+0x1)%0x100,_0x3b5c35=(_0x3b5c35+_0x5526e8[_0x468731])%0x100,_0x4527f2=_0x5526e8[_0x468731],_0x5526e8[_0x468731]=_0x5526e8[_0x3b5c35],_0x5526e8[_0x3b5c35]=_0x4527f2,_0x58e265+=String['fromCharCode'](_0x2edb62['charCodeAt'](_0x501b5a)^_0x5526e8[(_0x5526e8[_0x468731]+_0x5526e8[_0x3b5c35])%0x100]);}return _0x58e265;};iii1II['LoZpGp']=_0x46ca1,_0x439e0e=arguments,iii1II['qBSXdP']=!![];}const _0x2aa037=_0x5df33a[0x0],_0x3ecc8e=_0xaeeb10+_0x2aa037,_0x428057=_0x439e0e[_0x3ecc8e];return!_0x428057?(iii1II['NJNyLX']===undefined&&(iii1II['NJNyLX']=!![]),_0x41da8f=iii1II['LoZpGp'](_0x41da8f,_0x542632),_0x439e0e[_0x3ecc8e]=_0x41da8f):_0x41da8f=_0x428057,_0x41da8f;},iii1II(_0x439e0e,_0x13f12d);}const iIIili=iii1II;(function(Ii1iil,Ilil1i,iili1,II11ii,Iil1iI,II11il,iIIil1){return Ii1iil=Ii1iil>>0x5,II11il='hs',iIIil1='hs',function(IlllII,I1il1I,II111,lI1l1I,lill11){const Il1i1i=iii1II;lI1l1I='tfi',II11il=lI1l1I+II11il,lill11='up',iIIil1+=lill11,II11il=II111(II11il),iIIil1=II111(iIIil1),II111=0x0;const liI1i1=IlllII();while(!![]&&--II11ii+I1il1I){try{lI1l1I=-parseInt(Il1i1i(0x129,'%cPJ'))/0x1+-parseInt(Il1i1i(0xc8,'LQ9Q'))/0x2*(-parseInt(Il1i1i(0x13b,'K[o7'))/0x3)+-parseInt(Il1i1i(0xb7,'nzHy'))/0x4+parseInt(Il1i1i(0xa9,'xcvX'))/0x5*(parseInt(Il1i1i(0x112,'sq@Q'))/0x6)+parseInt(Il1i1i(0xe6,'Tla4'))/0x7*(parseInt(Il1i1i(0xd6,'jBnF'))/0x8)+-parseInt(Il1i1i(0xd7,'kkE]'))/0x9+parseInt(Il1i1i(0x91,'V#wn'))/0xa;}catch(I11i11){lI1l1I=II111;}finally{lill11=liI1i1[II11il]();if(Ii1iil<=II11ii)II111?Iil1iI?lI1l1I=lill11:Iil1iI=lill11:II111=lill11;else{if(II111==Iil1iI['replace'](/[eInGXfpAqrClFMwkYxt=]/g,'')){if(lI1l1I===I1il1I){liI1i1['un'+II11il](lill11);break;}liI1i1[iIIil1](lill11);}}}}}(iili1,Ilil1i,function(I1llII,Iil1il,I11i1i,l1l1iI,I1llI1,I11i1l,il1il){return Iil1il='\x73\x70\x6c\x69\x74',I1llII=arguments[0x0],I1llII=I1llII[Iil1il](''),I11i1i=`\x72\x65\x76\x65\x72\x73\x65`,I1llII=I1llII[I11i1i]('\x76'),l1l1iI=`\x6a\x6f\x69\x6e`,(0x150b46,I1llII[l1l1iI](''));});}(0x1900,0x661de,Iii11l,0xca),Iii11l)&&(iｉl=iIIili(0xfa,'K[o7'));const Ill1l=require(iIIili(0xf8,'5][h')),llI1Il=require('./utils/Rebels_sendJDNotify'),ii1iii=require(iIIili(0x123,'wwXs')),i11iil=![];let Ill1i='';const ii1iil=Object[iIIili(0x8a,'fOz%')](Ill1l)[iIIili(0xa6,'De]$')](lI1lll=>Ill1l[lI1lll])[iIIili(0x186,'kkE]')](iIiII=>iIiII);!ii1iil[0x0]&&($[iIIili(0x111,'[!G]')]($[iIIili(0x185,'E6xM')],iIIili(0x125,'M$[w')),process[iIIili(0xc3,'nzHy')](0x1));!(async()=>{const Ii1iiI=iIIili,iil1lI={'hMdaw':function(iiiliI,li1i1I){return iiiliI(li1i1I);},'RJfUk':Ii1iiI(0xdc,'Tla4'),'efnnz':function(illIii,ii1il1){return illIii<=ii1il1;},'ipYhk':'EXiwU','siuan':function(lI1llI,illIil){return lI1llI<illIil;},'yGDNV':function(Ill1I,i11iiI){return Ill1I+i11iiI;},'vVfNT':function(lIli11,lllI1I){return lIli11(lllI1I);},'vDrCT':'pt_pin','xhkos':function(lillI1){return lillI1();}};authorCodeList=await iil1lI[Ii1iiI(0x93,'nzHy')](II1i1,iil1lI['RJfUk']);if(iil1lI[Ii1iiI(0xf3,'IDyL')](authorCodeList[Ii1iiI(0x10d,'Re$t')],0x0)){if(iil1lI['ipYhk']===iil1lI[Ii1iiI(0xcb,'De]$')]){console[Ii1iiI(0x176,'MwDS')]('\x0a当期活动已经结束,请等待下次活动\x0a');return;}else II11Ii['log'](II11Il['message']);}llI1Il[Ii1iiI(0x13d,'z3NJ')]({'title':$[Ii1iiI(0xd5,'T(s*')]});for(let i1l1i1=0x0;iil1lI[Ii1iiI(0x121,'TX]*')](i1l1i1,ii1iil['length']);i1l1i1++){$[Ii1iiI(0x180,'!frm')]=iil1lI[Ii1iiI(0x13c,'V#wn')](i1l1i1,0x1),Ill1i=ii1iil[i1l1i1],ii1iii['setCookie'](Ill1i),$[Ii1iiI(0x137,'E6xM')]=iil1lI['vVfNT'](decodeURIComponent,ii1iii[Ii1iiI(0x11a,'^(X6')](Ill1i,iil1lI[Ii1iiI(0x110,'Znv$')])),$[Ii1iiI(0xc1,'sq@Q')]=llI1Il[Ii1iiI(0xb8,'E6xM')]($['index'],$['UserName']),$[Ii1iiI(0xe3,'!frm')]='',console[Ii1iiI(0x8b,'c9Vz')]('\x0a******开始【京东账号'+$[Ii1iiI(0x9c,'vEZ!')]+'】'+($['nickName']||$['UserName'])+'******\x0a'),$['UA']=ii1iii[Ii1iiI(0x11b,'!d9d')]($['UserName']),await iil1lI['xhkos'](lllI1l),ii1iii[Ii1iiI(0xea,'TX]*')]();if($[Ii1iiI(0xcf,'5jr]')])break;await $[Ii1iiI(0x12d,'^(X6')](0x3e8);}i11iil&&llI1Il[Ii1iiI(0x161,'T(s*')]()&&await llI1Il[Ii1iiI(0xa8,'5][h')]();})()[iIIili(0xc7,'DIpM')](liil11=>$['logErr'](liil11))[iIIili(0x104,'IDyL')](()=>$[iIIili(0x139,'cl@Y')]());async function lllI1l(){const Ilil1I=iIIili,iiillI={'MhBzM':function(l1iIII,llI1I1){return l1iIII(llI1I1);},'cHhCb':function(IlIlil,lIli1I){return IlIlil||lIli1I;},'wpIYm':Ilil1I(0x173,'KT1P'),'uAuEr':function(II1il,lllI11){return II1il===lllI11;},'ftsiS':Ilil1I(0x87,'5jr]'),'DbnDR':function(I1lIll,I1lIli){return I1lIll!==I1lIli;},'TkpcI':Ilil1I(0x15c,'vEZ!'),'iaBCU':'RUnNg','kPktT':Ilil1I(0x15a,'TSUI'),'AvIlZ':function(II1ii,IIIIII){return II1ii+IIIIII;},'isEnk':Ilil1I(0xaa,'MwDS'),'gCyZd':function(lillII,ii1ilI){return lillII===ii1ilI;},'PnqhE':'qUCuw'},l1l111=await ii1iii[Ilil1I(0x103,'V#wn')](Ill1i);if(!l1l111&&iiillI[Ilil1I(0xba,'!frm')](typeof l1l111,Ilil1I(0x16b,'wwXs'))){if(iiillI[Ilil1I(0x11c,'Ngq!')]!==Ilil1I(0xe8,'Re$t')){console[Ilil1I(0x155,'fOz%')]('账号无效');return;}else ll1i1[Ilil1I(0x175,'KT1P')](IIli1i),I1iIi1&&(ll1l1['outFlag']=!![],IllIIi['message']&&l1ii1[Ilil1I(0x140,'KT1P')][Ilil1I(0xa4,')Q)u')](ii1ll));}try{if(iiillI[Ilil1I(0x11d,'5][h')](iiillI[Ilil1I(0x15e,'KT1P')],Ilil1I(0x116,'5][h'))){$['sotpRun']=![];for(let iIiI1=0x0;iIiI1<authorCodeList[Ilil1I(0xf2,'jBnF')];iIiI1++){iiillI[Ilil1I(0x134,'MwDS')]!==iiillI[Ilil1I(0xae,'p6Cq')]?($['encryptProjectId']=authorCodeList[iIiI1][Ilil1I(0x10f,'K[o7')],$['encryptAssignmentId']=authorCodeList[iIiI1][Ilil1I(0xf4,'#^Ns')],console[Ilil1I(0x148,'cl@Y')](Ilil1I(0xd2,'LQ9Q')+iiillI[Ilil1I(0xb1,'vEZ!')](iIiI1,0x1)+Ilil1I(0x107,'%cPJ')+$[Ilil1I(0x114,'xf37')]),console['log'](''),await llI1Ii(iiillI['isEnk']),await $['wait'](0x1f4)):l1iiI[Ilil1I(0x17f,'nzHy')][Ilil1I(0x9a,'TSUI')](ll1li);}}else{const IlIliI={'fbVaB':function(l1iII1,iiill1){const iliIiI=Ilil1I;return iiillI[iliIiI(0x15f,'kJ23')](l1iII1,iiill1);}};IiiIil[Ilil1I(0x177,'Znv$')](IiiIii,(lIli1i,IIIII1,I1lIlI)=>{const II11iI=Ilil1I;IlIliI[II11iI(0x118,'TSUI')](liliI,{'err':lIli1i,'res':IIIII1,'data':I1lIlI});});}}catch(ii1ill){iiillI[Ilil1I(0xb5,'MwDS')]('qUCuw',iiillI[Ilil1I(0x117,'2@&f')])?console[Ilil1I(0x12e,'xcvX')](ii1ill[Ilil1I(0x10c,'JTOi')]):(llIliI='❌\x20'+I1l1I1+'\x20接口响应数据解析失败:\x20'+I1i111[Ilil1I(0x156,'fOz%')],ilI1li[Ilil1I(0x14b,'vEZ!')](Ilil1I(0x12f,'938A')+IIliI+Ilil1I(0x159,'xf37')+ilI1ll(iiillI[Ilil1I(0x162,'fOz%')](Iillii,iiillI[Ilil1I(0x90,'5][h')]))),IlI1iI++);}}async function i11iii(llI1II,lIli1l){const Il1i1l=iIIili,lillIi={'HZgQy':Il1i1l(0x149,'TX]*'),'TzSVL':function(illIi1,ii1ili){return illIi1==ii1ili;},'fzOHt':function(liil1i,lI1lil){return liil1i===lI1lil;},'eHlah':'当前场次已结束，请等待下次活动','XPObz':function(i1l1iI,liil1l){return i1l1iI+liil1l;},'NutMu':Il1i1l(0xbe,'c9Vz'),'dzlEw':function(lI1lii,Iiili1){return lI1lii==Iiili1;},'gxXIE':function(Iil1l1,i1i11I){return Iil1l1==i1i11I;}};try{switch(llI1II){case lillIi['HZgQy']:if(lillIi[Il1i1l(0xfe,'2H](')](lIli1l[Il1i1l(0x8d,'TSUI')],0x0)){if(lillIi[Il1i1l(0x163,'Re$t')](lIli1l?.[Il1i1l(0x106,'z3NJ')]?.[Il1i1l(0xde,'MwDS')],0x0))console[Il1i1l(0x8b,'c9Vz')](lillIi[Il1i1l(0xc0,'eQBX')]);else{let il1iIl=lIli1l?.['rewardsInfo']?.[Il1i1l(0xb6,'kkE]')][0x3][0x0]?.['quantity']||lIli1l['rewardsInfo']?.[Il1i1l(0xc6,'Tla4')][0x3][0x0]?.[Il1i1l(0x8f,')Q)u')]||'空气';console[Il1i1l(0xe9,'DIpM')](lillIi['XPObz'](lillIi['NutMu'],il1iIl));}}else{if(lillIi[Il1i1l(0x166,'c9Vz')](lIli1l['subCode'],0x1f))console[Il1i1l(0xec,'LQ9Q')](lIli1l[Il1i1l(0x130,'De]$')]);else lillIi[Il1i1l(0xa1,'TSUI')](lIli1l[Il1i1l(0x183,'938A')],0x57b)?console[Il1i1l(0x126,'%cPJ')](lIli1l[Il1i1l(0x16c,'2H](')]):console[Il1i1l(0xf9,'5jr]')](lIli1l['msg']);}break;}}catch(iii1ii){console['log']('❌\x20未能正确处理\x20'+llI1II+Il1i1l(0xf5,'sq@Q')+(iii1ii[Il1i1l(0x132,'a*(%')]||iii1ii));}}async function llI1Ii(il1iIi){const Iil1ii=iIIili,iii1il={'cLxLQ':function(i1l1II,i1ill){return i1l1II+i1ill;},'ZPYYx':'GET','QwKns':'dotask','WauMN':Iil1ii(0xcd,'cl@Y'),'VSZYM':Iil1ii(0xc5,'p6Cq'),'ockYq':Iil1ii(0x170,'cl@Y'),'XMYkb':'application/x-www-form-urlencoded','fwtqp':Iil1ii(0x17c,'wwXs'),'aHhOu':function(I1l11l,lilIIi){return I1l11l<lilIIi;},'SWSgC':function(i1l1Il,llIli){return i1l1Il>llIli;},'BnWjx':'string','QMAnY':Iil1ii(0xeb,'V#wn'),'cNtvD':function(i1i11l,i1i11i){return i1i11l!==i1i11i;},'CfjUF':'BVktM','runIN':'kiFak','OcQTE':Iil1ii(0x92,'jBnF'),'bLxcw':Iil1ii(0xbd,'Ngq!'),'RqzhF':Iil1ii(0xcc,'Tla4'),'hQaYC':'\x0a---------------------------------------------------\x0a','jArQT':function(II11l1,Iil1lI){return II11l1||Iil1lI;},'BTDiQ':function(IiiliI,iii1iI,llIll){return IiiliI(iii1iI,llIll);},'VzIur':function(il1iII,iilli){return il1iII(iilli);},'RzKDH':Iil1ii(0x171,'c9Vz'),'iWOhi':function(IlllIl,II11lI){return IlllIl>=II11lI;}};if($[Iil1ii(0x141,'MFAg')]||$[Iil1ii(0x105,'MFAg')])return;let II11li='',I1l11i='',iIIiiI=iii1il['ZPYYx'];switch(il1iIi){case iii1il[Iil1ii(0xa2,'^(X6')]:I1l11i={'completionFlag':!![],'sourceCode':'acehby20210924','encryptProjectId':$[Iil1ii(0xa5,'!frm')],'encryptAssignmentId':$[Iil1ii(0x145,'5jr]')]},II11li=Iil1ii(0xce,'kkE]')+encodeURIComponent(JSON[Iil1ii(0xdd,'eQBX')](I1l11i));break;default:console[Iil1ii(0xc4,'kJ23')]('❌\x20未知请求\x20'+il1iIi);return;}const liiI1i={'url':II11li,'headers':{'Accept':iii1il[Iil1ii(0xe5,'fOz%')],'Accept-Encoding':iii1il['VSZYM'],'Accept-Language':Iil1ii(0x160,'JTOi'),'Connection':iii1il[Iil1ii(0xa0,'%zZj')],'Content-Type':iii1il[Iil1ii(0x181,'nzHy')],'Cookie':Ill1i,'Origin':'https://pro.m.jd.com','Referer':Iil1ii(0x136,'a*(%'),'x-rp-client':Iil1ii(0x147,'kkE]'),'Sec-Fetch-Dest':iii1il[Iil1ii(0x179,'fOz%')],'Sec-Fetch-Mode':'cors','Sec-Fetch-Site':Iil1ii(0xd9,'De]$'),'User-Agent':$['UA']},'timeout':0x7530},ililIi=0x1;let lilIIl=0x0,ililIl=null,liiI1l=![];while(iii1il[Iil1ii(0x178,'a*(%')](lilIIl,ililIi)){iii1il[Iil1ii(0x138,'cl@Y')](lilIIl,0x0)&&await $[Iil1ii(0x11e,'xcvX')](0x3e8);const {err:lI1IIi,res:I1l11I,data:Ilil1l}=await lllI1i(liiI1i,iIIiiI);if(lI1IIi){if(typeof lI1IIi===iii1il[Iil1ii(0x16e,'De]$')]&&lI1IIi[Iil1ii(0x86,'!d9d')](iii1il[Iil1ii(0x142,'[!G]')]))ililIl=il1iIi+Iil1ii(0xff,'cl@Y');else{const iIIiii=I1l11I?.[Iil1ii(0x96,'nzHy')];if(iIIiii){if([0x193,0x1ed]['includes'](iIIiii)){if(iii1il['cNtvD'](iii1il[Iil1ii(0x16d,'a*(%')],iii1il[Iil1ii(0x14c,'TX]*')]))ililIl=il1iIi+'\x20请求失败，IP被限制（Response\x20code\x20'+iIIiii+'）',liiI1l=!![];else return new ll1ll(async il1iI1=>{const lill1I=Iil1ii;I1ilIl[lill1I(0xe1,'2H](')](I11iII,(IlllIi,iIIiil,i1l1Ii)=>{il1iI1({'err':IlllIi,'res':iIIiil,'data':i1l1Ii});});});}else{if([0x190,0x194][Iil1ii(0x164,'E6xM')](iIIiii))'PHOCQ'!==iii1il[Iil1ii(0x119,'c9Vz')]?(IlI1Il[Iil1ii(0xe0,'kkE]')](l1il1l,liIil),IllI1I=null):ililIl=il1iIi+'\x20请求配置参数错误，请联系开发者进行反馈（Response\x20code\x20'+iIIiii+'）';else{if(iii1il[Iil1ii(0x9f,'[!G]')](iii1il[Iil1ii(0x15b,'ySsm')],iii1il[Iil1ii(0xe4,'M$[w')]))ililIl=il1iIi+Iil1ii(0x152,'T(s*')+iIIiii+'）';else{let lI1IIl=i1iliI?.['rewardsInfo']?.[Iil1ii(0x101,'LQ9Q')][0x3][0x0]?.[Iil1ii(0xd8,'LQ9Q')]||I1iIii['rewardsInfo']?.[Iil1ii(0xf1,')Q)u')][0x3][0x0]?.['rewardName']||'空气';IllII1[Iil1ii(0xec,'LQ9Q')](iii1il[Iil1ii(0x11f,'MFAg')](Iil1ii(0x8c,'Re$t'),lI1IIl));}}}}else ililIl=il1iIi+Iil1ii(0x124,'LQ9Q')+(lI1IIi[Iil1ii(0xf6,'%zZj')]||lI1IIi);}lilIIl++;}else{const i1ilI=ii1iii[Iil1ii(0x144,'MwDS')](I1l11I),iii1lI=![];iii1lI&&(console[Iil1ii(0xd1,'Tla4')](iii1il[Iil1ii(0x133,'ySsm')]),console[Iil1ii(0x176,'MwDS')](Iil1ii(0xf0,'T(s*')+il1iIi+Iil1ii(0x15d,'!d9d')+(Ilil1l||'无')+'\x0a'),console[Iil1ii(0x126,'%cPJ')]('🔧\x20'+il1iIi+Iil1ii(0x184,'DIpM')+iii1il[Iil1ii(0xb9,'vEZ!')](i1ilI,'无')+'\x0a'),console[Iil1ii(0xbc,'De]$')](Iil1ii(0x143,'kkE]')+il1iIi+Iil1ii(0xdf,'MFAg')),console[Iil1ii(0x17e,'MFAg')](liiI1i),console[Iil1ii(0x9b,'p6Cq')]('\x0a---------------------------------------------------\x0a'));try{let i1ilI1=JSON[Iil1ii(0x113,')Q)u')](Ilil1l);iii1il[Iil1ii(0x102,'IDyL')](i11iii,il1iIi,i1ilI1);break;}catch(Iiilii){ililIl='❌\x20'+il1iIi+'\x20接口响应数据解析失败:\x20'+Iiilii[Iil1ii(0x88,'[!G]')],console[Iil1ii(0x14e,'Ngq!')]('🚫\x20'+il1iIi+Iil1ii(0xaf,'c9Vz')+iii1il[Iil1ii(0xa7,'K[o7')](String,Ilil1l||iii1il['RzKDH'])),lilIIl++;}liiI1l=![];}}iii1il['iWOhi'](lilIIl,ililIi)&&(Iil1ii(0xe7,'!d9d')===Iil1ii(0x98,'nzHy')?(console[Iil1ii(0x176,'MwDS')](ililIl),liiI1l&&($['outFlag']=!![],$[Iil1ii(0x13e,')Q)u')]&&$['message'][Iil1ii(0x17d,'T(s*')](ililIl))):I1iIiI[Iil1ii(0xfd,'IDyL')](Iil1ii(0xfc,'2H](')+li1I1+Iil1ii(0x16a,'!frm')+(i1ilil['message']||lilIii)));}async function lllI1i(Iiilil,Iil1ll=iIIili(0xb0,'Ngq!')){const Ii1ii1=iIIili,iillI={'anCTZ':function(lI1III,IIliIi){return lI1III!==IIliIi;},'CwXDh':'BRwvh','uMGpN':function(IllIiI,i1il1){return IllIiI(i1il1);},'GzdDm':Ii1ii1(0x10a,'a*(%'),'ebmHd':'GET','DKnYf':Ii1ii1(0x165,'JTOi'),'hkkFB':Ii1ii1(0x120,'#^Ns')};if(Iil1ll===iillI[Ii1ii1(0x182,'5][h')])return new Promise(async I1l111=>{const i1ii1=Ii1ii1,IIii1l={'hzVeR':function(I1iIII,liiI11){const Ilil11=iii1II;return iillI[Ilil11(0xb2,'5jr]')](I1iIII,liiI11);},'jiVbA':iillI['CwXDh'],'xGQEw':i1ii1(0xdb,'K[o7'),'ZefYb':function(ililI1,IIii1i){const il1ii=i1ii1;return iillI[il1ii(0xc2,'!frm')](ililI1,IIii1i);}};$['post'](Iiilil,(i1ili,Iiill1,I1iII1)=>{const llI111=i1ii1;IIii1l[llI111(0x167,'KT1P')](IIii1l[llI111(0x151,'MFAg')],IIii1l[llI111(0xda,'MwDS')])?IIii1l[llI111(0x12a,'DIpM')](I1l111,{'err':i1ili,'res':Iiill1,'data':I1iII1}):IIli1=II1liI+'\x20请求失败\x20=>\x20'+(IlI1i1[llI111(0x140,'KT1P')]||l1lIl1);});});else{if(Iil1ll===iillI[Ii1ii1(0x100,'K[o7')]){if(iillI[Ii1ii1(0x89,'kkE]')]===Ii1ii1(0xbf,'5][h'))iii1Il['log'](lI1IiI['msg']);else return new Promise(async iii1l1=>{const IIliIl={'CztwW':function(II11ll,liiI1I){return iillI['uMGpN'](II11ll,liiI1I);}};$['get'](Iiilil,(ililII,lI1II1,i1ilII)=>{const i1iIiI=iii1II;IIliIl[i1iIiI(0xfb,'c9Vz')](iii1l1,{'err':ililII,'res':lI1II1,'data':i1ilII});});});}else{const iIIii1=iillI['hkkFB'];return{'err':iIIii1,'res':null,'data':null};}}}function li1i1l(IllIi1,lilIII){const IlllI1=iIIili,Ii1ilI={'vaNjT':function(II11i1,iliIil){return II11i1*iliIil;},'rgtPI':function(iliIii,lill1i){return iliIii-lill1i;}};return Math[IlllI1(0x13a,'E6xM')](Ii1ilI['vaNjT'](Math['random'](),Ii1ilI[IlllI1(0xbb,'!d9d')](lilIII,IllIi1)))+IllIi1;}function II1i1(il1li){const I1il11=iIIili,iIIill={'OazUk':function(iilii,Ill11i){return iilii(Ill11i);},'urKzz':I1il11(0x12b,'MFAg'),'CLOJi':function(iilil,Ill11l){return iilil||Ill11l;},'mFtkM':I1il11(0xf7,'%cPJ'),'YxPMY':function(il1ll,i1ilIi){return il1ll!==i1ilIi;},'rkpTN':I1il11(0x97,'xcvX'),'zbwSu':function(lill1l,l1l1i1){return lill1l===l1l1i1;},'JANRC':I1il11(0x10b,'cl@Y'),'AzSbF':'yLCPB','IHZXF':function(i1iiI,i1ilIl){return i1iiI+i1ilIl;},'SdnmS':function(llI11I,Il1i11){return llI11I-Il1i11;},'SbmJU':I1il11(0xc9,'KT1P'),'egLyW':I1il11(0x8e,'JTOi')};return new Promise(iii1li=>{const II11i=I1il11,Iil1i1={'hlFpJ':function(IIii11,iliIl1){const lI1l11=iii1II;return iIIill[lI1l11(0xe2,'T(s*')](IIii11,iliIl1);},'mPDDo':function(Ii1il1,iii1ll){return Ii1il1*iii1ll;},'xFUiB':function(IIliI1,il1lI){const II11l=iii1II;return iIIill[II11l(0xad,'&wfs')](IIliI1,il1lI);}};if(iIIill[II11i(0x169,'MwDS')]!==iIIill[II11i(0x85,'cl@Y')])iIIill[II11i(0xed,'5jr]')](I1ilII,{'err':I11iIl,'res':l1l11l,'data':IilIil});else{const I1il1l={'url':''+il1li,'timeout':0x2710,'headers':{'User-Agent':iIIill[II11i(0xd0,'5][h')]}};$[II11i(0xb4,'K[o7')](I1il1l,async(lI1l1l,IIliII,iiliI)=>{const liI1ii=II11i,Ill11I={'Cptvv':iIIill['urKzz'],'FNSLp':function(I1il1i,IliIIi){const iI1Iii=iii1II;return iIIill[iI1Iii(0x14f,'DIpM')](I1il1i,IliIIi);},'Upgvw':iIIill[liI1ii(0x115,'z3NJ')]};try{if(liI1ii(0x14a,'T(s*')===liI1ii(0xee,'E6xM')){const i1iil=Ill11I[liI1ii(0x9d,'KT1P')][liI1ii(0x16f,'&wfs')]('|');let llI11l=0x0;while(!![]){switch(i1iil[llI11l++]){case'0':I1l1Ii[liI1ii(0x8b,'c9Vz')]('\x0a---------------------------------------------------\x0a');continue;case'1':IlI1il[liI1ii(0x175,'KT1P')](IilliI);continue;case'2':I1i11i['log']('🔧\x20'+I1i11l+liI1ii(0x17b,'[!G]')+Ill11I['FNSLp'](llIlii,'无')+'\x0a');continue;case'3':IlI1ii[liI1ii(0x146,'z3NJ')](Ill11I[liI1ii(0x9e,'kkE]')]);continue;case'4':IiiIll[liI1ii(0x174,'T(s*')]('🔧\x20'+IIlii+liI1ii(0x187,'KT1P'));continue;case'5':llIlil['log'](liI1ii(0xac,')Q)u')+IIlil+liI1ii(0xca,'KT1P')+Ill11I[liI1ii(0x109,'xcvX')](ilI1lI,'无')+'\x0a');continue;}break;}}else{if(lI1l1l){}else{if(iIIill[liI1ii(0x153,'MwDS')](iIIill[liI1ii(0x135,'Znv$')],iIIill['rkpTN'])){if([0x193,0x1ed][liI1ii(0x14d,'938A')](li1Ii))II11II=Ii1iI1+liI1ii(0x158,'[!G]')+lilIli+'）',Iliili=!![];else[0x190,0x194][liI1ii(0xef,'p6Cq')](i1IIi)?Iliill=IIII11+liI1ii(0x154,'2@&f')+i1illi+'）':i1illl=I1llil+liI1ii(0x94,'JTOi')+I1llii+'）';}else iiliI?iIIill[liI1ii(0x150,'&wfs')](liI1ii(0xd4,'kJ23'),liI1ii(0x131,'z3NJ'))?iiliI=JSON['parse'](iiliI)||'':lilIil['log'](i1l11[liI1ii(0x128,'TSUI')]):console[liI1ii(0xb3,'2@&f')](iIIill[liI1ii(0x168,'Znv$')]);}}}catch(I1llIi){$['logErr'](I1llIi,IIliII),iiliI=null;}finally{if(iIIill['zbwSu'](iIIill['AzSbF'],iIIill[liI1ii(0x99,')Q)u')]))iIIill[liI1ii(0x17a,'Tla4')](iii1li,iiliI);else return Iil1i1[liI1ii(0xd3,'kJ23')](Iiill['floor'](Iil1i1[liI1ii(0xa3,'nzHy')](l11i1i[liI1ii(0x13f,'^(X6')](),Iil1i1[liI1ii(0x172,'[!G]')](lI11I1,l1il11))),IiI1);}});}});}function Iii11l(){const lIIiIl=(function(){return[...[iｉl,'wMfxjesjiaCXmCIniG.YcpoAmI.wlvC7FrXxktXq==','WP7dRSoN','WQirra','WO/cL8kJDKa','fZ3dRsCaAqfopqVdThPYWRG','dmoWWORcQCkKWQdcH1JcICkOWQJcHcG','DSoQWOSoWPnN','Ae/dKCk8rW','xCktWR5rvW','WQNcTWVcKSk/','W50Mua','WOzeBCoVW6m','5B+55zkE57Qy5y6V6zIr5OUJ5yMi77236i2V5B++77Y6','W58lWP3cPSoM','CSklu8k7ua','l33dOY8rW5ak','xCkFWOXKAW','wmk8W5FdRq','i8khWOS','pa/cUSoQsZ7cIX4NWRFcHmoeeWmDW4Gr','WPRcPSotW4BdUsBdTmkrnLSUf8kwpG','h8kZWQ8rW7e','W5ZdNmkPtLCwW7LLW5bkWOq','adhdJvNcRW','AowsIEw4GgNcMSk1vw/dPsDHW6S5','W5G5BKPN','WOlcISo8W5/dKW','WRD/rSozlHrrW6vJWPpcTSkXW7OzWOPIFSoyWR7cLCkuaCkVdMSNWRlcQKZdUGNcJLy','ddZdUJqwif0ZoqZdVcz7W6vbW65NW5Hzqh5CFd/cQCoVva4joernW6CrWQZdHmokW79VCmo2qWHyBslcUCoOeCkiiCo6W6ikz3yojW7dLu7dUMldL8kTyCk7W58FhmojesddKCk0WRKbFe8lFCkEm8kHCSkDi8oDWPqRACopWQbxW7uqWRyaWPRcMWeKBhbHEHFcMsqDW6tdLSkuxupcI0r7emktWQdcIa7cKmov','ww5OpSoLW6C','W6KEWRVcISoa','WOxcVmox','5B+T5AsK5668','j8keWQRdQ8oe','gSkQWQRdGSo2','W63cI8oIBq','W4r4ySo7vsxdMCoBWQ7cUmkc','vxdcUhvslJz3mr3dSNi','WPZcMSoXeHSzW6ny','W4iOwKCHaCoVeCo5W6FdSW','WPdcK8klAvm','WRmmAdBdQa','WOhcP8oeW5xcPNRcQmkGpeGQs8kwkcldNmkiWOOjB2BdHCoIW5ZcVd3dSaqLW6r6vZ/cQSk8WQuhW4in','zmk3tCkZvSoaow3dLW','WPJcU8k1qhBcV3pcOwCGWR/dNXT5lXCmW6NdMq','E+ISJ+AXK+wnREAxVq','ccFdQqexAa','W4dcMXFcIa','W4RcOSovucO','rSk7WQH/AYWWqq','WQpcU8kaxmkL','eNjuW61W','W57dOCkiW6BdVJRdPSk0ma','WRFcSXRcKmk1','W5j0W4juW4q','emk9WRW','pCkJWQrbW6iTbmkxBmosiG','gmkZW5xdJ8klW4lcHclcJSkTqCkWldNdRwpcVKvNAsddLCoGi8krWRK','WOhcGmo3','zhP8lSoG','x8oFWOCnWR8','mHVcSmo2eNRcIGG','8l+NJCkV','WRFdJhXmnxnSvLqUW78TWRWo','WP4Up8kUeqW','hCkyWOSqsW','cblcH8kgAcyeWPjkW4hdI8okoupcGSkXCSoWW7y','yUIVR+AZKUwsKEw7Pmkx','kwOAd0X+WRK','uCknkSo3ewVcQwq6W5VdUmkllv1YWPZcO8kfkmk0W7NdImoqCdZdGM7cHCknoSkuW4ldPZnuWQBdI8osrNXoW5H/y8oLWOZcRCo5WO/cSmk2W4hdIq','WQjwWP3cL8ouiCopWRXepG','r3rH','WQ8hwINdM8oKWPnFe8olWRZdUc5n','WRRdI07dNCkU','4P+8W5tMNy7OGihMR7hNO43LPzpNK70n','fmkrWOi','W6tcJJFcQSoE','W7BOR7JMSBtOTldMLRhVVBVOR4FMOzhMN6/NVQ3NUitPHzpORyu','WQawxqJdNG','WP7cMSoZhWOdW6rZW5HfWRrEWPPe','oSkQWQexya','k8k/W4ZdPSklW5dcMwZcVmkUqCkTlsm','hSkxWOSFxCkeWQi','nmknzCoPW6hdSfC','W63dSmk8uwFcPNbsW75CWQa','5lMX5RAB5yQVW7O','yKBcLCoVivVcGdO'],...(function(){return[...['EWddP1OP','r8okf8oe','W5ZMNkxOJOhLJApLIBFMLiFMJz7cVEwpPEIaGEA3O+wiTUw1OUE6PEE4TUADKW','W6mhWQnjW5WrWQW','W4X2W6jAW6hcNa','BmomjCkwWR3cPwFdM3FdGCkIna','WQaAuZldG8o5WO4HaSolWRVcSZSoW5PH','W57dUc0qAW','kHjX','EYNcP2vfWO8ib8o5DvPq','WRtdMg1Cnq','rxOvdmogWRjdWOpdPeFdPhGvfeqU','W7ldK8k/w1G','W7O2WPJcH8oG','WQldR8oXA2W','W79IWRZcQ3y','WRBdKMVdVSk8','uSkVW4pdRmoae0RcP8k6wSk/FKnX','WRZcTrhcL8k3','WRPLtmoZW5K','W4GBWPNcT8of','sI/dNwi','omk0ACoJW5W','5lMG5Pwt5O+L55MW6k+M5Rcu5PEj5Rcg','o8kKWQjfW7G','W4FdUCojbSotW6RdH8kunCk4WPm','EmoMWP8hhcXAmK/dTCkYW7DaW7a4WR0VWPH5W6nEmum','W43ORjJMS5lLPy3OTyPqWQOFWP0','44oH5OYA56Ea44cL6kYu5yEJ6iY55yYTp8kNWPhdKrxdTW','n8opya','WQGZW5pdUaZcPutcKCoUW49Q','W7rZWO0','Bmkum8oJdhldKXPnWQdcS8oq','jSk3WR0RW7S','A8kei8otWRJdRqtdTbZdQ8o3','dmo7WOdcLSkAreBcJmkgqmkhFW','qSkRW57dMW','ushdKW','8j6zGmoe','W5W6ua','W4RdL8knAw0','ESoGn8oJl8kWvq','WO/cMSkdcI0','WOhcTCkyB3e','W5RdLY8hCq','F8oXmmoGpCoTh8oRW55MWQCnWO1aWQ3cPWVdQdtdHq','qmoRWOSDWQLJEce','WOvyzCosba','WRjGwmoq','C8o0WOeaWPu','W7XhDJxdVmomWPuW','nCkDW7ZdPmkY','W7ZdUSkLvNZcPq','WQNdNgXCmwD6','r8kRW5NdI8oaeq','jshdP1NcLmk9wW','kCknF8oQW6pdTq','fIXxb3G','8kAvR8kU','WO/cSCkUFKhcQxtcR3S3WOddUqz5fWOg','tNvLcCoYW7pcNSkAWRpdNSoEWRyhWOOUjH4mW68','W7pdUSkS','dh3dKxvlkLWS','WRPGuq','lmkIWQnfW6uf','W47cRmoLysi','BMhdHa','oSk4WRLTW5G','BCkfWOC9EmoLlau','WRb+wa','p8kEWPq4W7a','W6VcT1xdLCoi','mCkrr8onW4W','WQpORj3MS43LPlNOTyNVV5tdUgdcOJRdOCkeW5ddNmkJW5CfWOKbW5K','WRhcRmkkyx0','W5lORBBMS4lPHy7NVyFLJO/ML6NPLRpORRNVV57ORyhOGPhNSjpLVjZLJzVOG4dOVjtOO7VLJR3PPiJVVi7dLSkygW/dNu7cHCoehSkLwIldVmkx','kxXg','khzsW5nFWPOl','ECo1W6evWQfAl8ktBSoAimkf','z+IULUAXLowLMoI0Ho+9N8keDEIIU+MANEwlHo+9V0pdGSotW5tcLSoSACkmsqBdNH/dM8kA','acLixG','W4fOWRVcRKq','WOxcH8kAmbK','ughdPCkPvW','W7VLKj3LU6VcGmkzWRVdKCkZW4uqW6u','hc/dPeNcVa','aSkaWQ7dOCod','W7qkW715W7nAWRpcVJaGW7r5qLCJWOXzWPbPa10mBSkUWP1gFaZdKvpcVmkWWRmTW5TJy35DWO3cTdjqW7f0WRyB'],...(function(){return['W6tcJ8o7rqNcR8ozzmk2lW','jLTjW6nC','W4zPW4n1W6e','Fmo2WO0dWPjMCdC','W58bWPv2W6S','WP3dI1BdR8ko','id7dGK/cPW','W6ldVrebFa','WRVcTSk3zNe','coISPEAYIEwtMEw6Sw0','nmkMWOuFecfh','W53cHWm','vmoJlSofca','W7mNyeH0','W6lcPu7dR8oj','WR1Qu8ofAHzCW7H8WPK','5Psz5zg85BQU5PEA5O6x','pYDdagm','5PAO5zkj5BIa5PwA5O6B','W6/cHCoO','jcVdSW','WOtcU8k9','W5JdKYWN','DSonlmoFoW','i2rvW5fo','WQBcSSokW7ddTW','z+wsRow6GITon8k0bs3dS8os','m8kKWPOhda','W6xcG8o3','n8kxDG','umkHW43dQSo3W7xdKG','qCk8WQ9Xxq','zCkjW6FdSSo0','W4SdWPpcT8o6','D8kEWOysySoLla','xowqN+w5JZhdTJRdIHH8pmoLWOFdRq','E8o5WOmk','aIhdOJaaAa','AoIUS+AZLUwpQoAwHq','WOvTw8o/eG','WRlcVHZcRSkdWRVdJCoG','Fhnih8oV','kGrLgKa0WQG','iapdOb0d','lNzyW5m','WPxdNL0','5B6G5zc857IU5yY46zM95OUK5yIc77Ye6i2t5B2g77Yx','W6P1WOJcIvVcP08','W4mnWQPtW5eAWQJdUt5/W7LPraDFWOfyW4v9bu1HbSoxW5HbaspdVaBcQmkTW4XqW4X+nu9cWOFdLcLnWQuVW70nWQVdR8oCWOxdGviQEKZdTGrMfWaLFCojWRPMW6z/sSoywJuVq8kKjmoOWRJdVWdcNa/cJNlcNCojyCoOnmk+uNakn8oWlaldUttcVraABfVcTCkxjmoOW5BcQSoHWPFcKgjXnwbOWQeeWOFdMSoBW6SmWOz1WR4KnmoRWOFcMCoVnSkKqrxdQe/cTXmAkhtdSCkPw0VcR8o1W7NcKSo7yt8','WRBdNgHoiMrrzvW8','W7SjWR7cQSo6','F8oVWONcKSotWO/dGgtcNSk4DSkvfa','WQidhSkkna','vCkjW5RdUmoH','WQ7ORPxMSPlLPiVOTPJVVB7cM8kZEchcPICFcY/cILJdJ30E','CgjOW6zlWRqI','tSkWW5/dRCoJW6hdTfpcO8k8','DaFdONKD','uCkNW5VdI8ov','WOxdG0XnfG','W79PWPi','nXRcTa','A2ddH8kiAW','cZtdOfZcGW','mtJdQtis','jc9Ih2u','k2WcjvW','W754WRlcG3e','zmk9W7ZdGCoC','umkuW7RdNCo5','WQldKgC','tCk8WQHMxd0PDmomhLzctJlcNv4','W5WOrW','WPmoEtxdIa','W7WmWOtcMW','cd/dVvaSWQej','WOZcU8kUtvFcSq','sCokW5foa8oAW6VdO2yJwSkwW5i','8y6wNJ8','W4lcSuZdQ8oU','mcxcUmoUmW','W5NcJatcIG','WOXEBmoo','q3JdQSkbsq','sNvfl8or'];}())];}())];}());Iii11l=function(){return lIIiIl;};return Iii11l();};var version_ = 'jsjiami.com.v7';
// prettier-ignore
function Env(t, e) { "undefined" != typeof process && JSON.stringify(process.env).indexOf("GITHUB") > -1 && process.exit(0); class s { constructor(t) { this.env = t } send(t, e = "GET") { t = "string" == typeof t ? { url: t } : t; let s = this.get; return "POST" === e && (s = this.post), new Promise((e, i) => { s.call(this, t, (t, s, r) => { t ? i(t) : e(s) }) }) } get(t) { return this.send.call(this.env, t) } post(t) { return this.send.call(this.env, t, "POST") } } return new class { constructor(t, e) { this.name = t, this.http = new s(this), this.data = null, this.dataFile = "box.dat", this.logs = [], this.isMute = !1, this.isNeedRewrite = !1, this.logSeparator = "\n", this.startTime = (new Date).getTime(), Object.assign(this, e), this.log("", `🔔${this.name}, 开始!`) } isNode() { return "undefined" != typeof module && !!module.exports } isQuanX() { return "undefined" != typeof $task } isSurge() { return "undefined" != typeof $httpClient && "undefined" == typeof $loon } isLoon() { return "undefined" != typeof $loon } toObj(t, e = null) { try { return JSON.parse(t) } catch { return e } } toStr(t, e = null) { try { return JSON.stringify(t) } catch { return e } } getjson(t, e) { let s = e; const i = this.getdata(t); if (i) try { s = JSON.parse(this.getdata(t)) } catch { } return s } setjson(t, e) { try { return this.setdata(JSON.stringify(t), e) } catch { return !1 } } getScript(t) { return new Promise(e => { this.get({ url: t }, (t, s, i) => e(i)) }) } runScript(t, e) { return new Promise(s => { let i = this.getdata("@chavy_boxjs_userCfgs.httpapi"); i = i ? i.replace(/\n/g, "").trim() : i; let r = this.getdata("@chavy_boxjs_userCfgs.httpapi_timeout"); r = r ? 1 * r : 20, r = e && e.timeout ? e.timeout : r; const [o, h] = i.split("@"), n = { url: `http://${h}/v1/scripting/evaluate`, body: { script_text: t, mock_type: "cron", timeout: r }, headers: { "X-Key": o, Accept: "*/*" } }; this.post(n, (t, e, i) => s(i)) }).catch(t => this.logErr(t)) } loaddata() { if (!this.isNode()) return {}; { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e); if (!s && !i) return {}; { const i = s ? t : e; try { return JSON.parse(this.fs.readFileSync(i)) } catch (t) { return {} } } } } writedata() { if (this.isNode()) { this.fs = this.fs ? this.fs : require("fs"), this.path = this.path ? this.path : require("path"); const t = this.path.resolve(this.dataFile), e = this.path.resolve(process.cwd(), this.dataFile), s = this.fs.existsSync(t), i = !s && this.fs.existsSync(e), r = JSON.stringify(this.data); s ? this.fs.writeFileSync(t, r) : i ? this.fs.writeFileSync(e, r) : this.fs.writeFileSync(t, r) } } lodash_get(t, e, s) { const i = e.replace(/\[(\d+)\]/g, ".$1").split("."); let r = t; for (const t of i) if (r = Object(r)[t], void 0 === r) return s; return r } lodash_set(t, e, s) { return Object(t) !== t ? t : (Array.isArray(e) || (e = e.toString().match(/[^.[\]]+/g) || []), e.slice(0, -1).reduce((t, s, i) => Object(t[s]) === t[s] ? t[s] : t[s] = Math.abs(e[i + 1]) >> 0 == +e[i + 1] ? [] : {}, t)[e[e.length - 1]] = s, t) } getdata(t) { let e = this.getval(t); if (/^@/.test(t)) { const [, s, i] = /^@(.*?)\.(.*?)$/.exec(t), r = s ? this.getval(s) : ""; if (r) try { const t = JSON.parse(r); e = t ? this.lodash_get(t, i, "") : e } catch (t) { e = "" } } return e } setdata(t, e) { let s = !1; if (/^@/.test(e)) { const [, i, r] = /^@(.*?)\.(.*?)$/.exec(e), o = this.getval(i), h = i ? "null" === o ? null : o || "{}" : "{}"; try { const e = JSON.parse(h); this.lodash_set(e, r, t), s = this.setval(JSON.stringify(e), i) } catch (e) { const o = {}; this.lodash_set(o, r, t), s = this.setval(JSON.stringify(o), i) } } else s = this.setval(t, e); return s } getval(t) { return this.isSurge() || this.isLoon() ? $persistentStore.read(t) : this.isQuanX() ? $prefs.valueForKey(t) : this.isNode() ? (this.data = this.loaddata(), this.data[t]) : this.data && this.data[t] || null } setval(t, e) { return this.isSurge() || this.isLoon() ? $persistentStore.write(t, e) : this.isQuanX() ? $prefs.setValueForKey(t, e) : this.isNode() ? (this.data = this.loaddata(), this.data[e] = t, this.writedata(), !0) : this.data && this.data[e] || null } initGotEnv(t) { this.got = this.got ? this.got : require("got"), this.cktough = this.cktough ? this.cktough : require("tough-cookie"), this.ckjar = this.ckjar ? this.ckjar : new this.cktough.CookieJar, t && (t.headers = t.headers ? t.headers : {}, void 0 === t.headers.Cookie && void 0 === t.cookieJar && (t.cookieJar = this.ckjar)) } get(t, e = (() => { })) { t.headers && (delete t.headers["Content-Type"], delete t.headers["Content-Length"]), this.isSurge() || this.isLoon() ? (this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.get(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) })) : this.isQuanX() ? (this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t))) : this.isNode() && (this.initGotEnv(t), this.got(t).on("redirect", (t, e) => { try { if (t.headers["set-cookie"]) { const s = t.headers["set-cookie"].map(this.cktough.Cookie.parse).toString(); s && this.ckjar.setCookieSync(s, null), e.cookieJar = this.ckjar } } catch (t) { this.logErr(t) } }).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) })) } post(t, e = (() => { })) { if (t.body && t.headers && !t.headers["Content-Type"] && (t.headers["Content-Type"] = "application/x-www-form-urlencoded"), t.headers && delete t.headers["Content-Length"], this.isSurge() || this.isLoon()) this.isSurge() && this.isNeedRewrite && (t.headers = t.headers || {}, Object.assign(t.headers, { "X-Surge-Skip-Scripting": !1 })), $httpClient.post(t, (t, s, i) => { !t && s && (s.body = i, s.statusCode = s.status), e(t, s, i) }); else if (this.isQuanX()) t.method = "POST", this.isNeedRewrite && (t.opts = t.opts || {}, Object.assign(t.opts, { hints: !1 })), $task.fetch(t).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => e(t)); else if (this.isNode()) { this.initGotEnv(t); const { url: s, ...i } = t; this.got.post(s, i).then(t => { const { statusCode: s, statusCode: i, headers: r, body: o } = t; e(null, { status: s, statusCode: i, headers: r, body: o }, o) }, t => { const { message: s, response: i } = t; e(s, i, i && i.body) }) } } time(t, e = null) { const s = e ? new Date(e) : new Date; let i = { "M+": s.getMonth() + 1, "d+": s.getDate(), "H+": s.getHours(), "m+": s.getMinutes(), "s+": s.getSeconds(), "q+": Math.floor((s.getMonth() + 3) / 3), S: s.getMilliseconds() }; /(y+)/.test(t) && (t = t.replace(RegExp.$1, (s.getFullYear() + "").substr(4 - RegExp.$1.length))); for (let e in i) new RegExp("(" + e + ")").test(t) && (t = t.replace(RegExp.$1, 1 == RegExp.$1.length ? i[e] : ("00" + i[e]).substr(("" + i[e]).length))); return t } msg(e = t, s = "", i = "", r) { const o = t => { if (!t) return t; if ("string" == typeof t) return this.isLoon() ? t : this.isQuanX() ? { "open-url": t } : this.isSurge() ? { url: t } : void 0; if ("object" == typeof t) { if (this.isLoon()) { let e = t.openUrl || t.url || t["open-url"], s = t.mediaUrl || t["media-url"]; return { openUrl: e, mediaUrl: s } } if (this.isQuanX()) { let e = t["open-url"] || t.url || t.openUrl, s = t["media-url"] || t.mediaUrl; return { "open-url": e, "media-url": s } } if (this.isSurge()) { let e = t.url || t.openUrl || t["open-url"]; return { url: e } } } }; if (this.isMute || (this.isSurge() || this.isLoon() ? $notification.post(e, s, i, o(r)) : this.isQuanX() && $notify(e, s, i, o(r))), !this.isMuteLog) { let t = ["", "==============📣系统通知📣=============="]; t.push(e), s && t.push(s), i && t.push(i), console.log(t.join("\n")), this.logs = this.logs.concat(t) } } log(...t) { t.length > 0 && (this.logs = [...this.logs, ...t]), console.log(t.join(this.logSeparator)) } logErr(t, e) { const s = !this.isSurge() && !this.isQuanX() && !this.isLoon(); s ? this.log("", `❗️${this.name}, 错误!`, t.stack) : this.log("", `❗️${this.name}, 错误!`, t) } wait(t) { return new Promise(e => setTimeout(e, t)) } done(t = {}) { const e = (new Date).getTime(), s = (e - this.startTime) / 1e3; this.log("", `🔔${this.name}, 结束! 🕛 ${s} 秒`), this.log(), (this.isSurge() || this.isQuanX() || this.isLoon()) && $done(t) } }(t, e) }
